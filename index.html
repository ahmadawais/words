<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#000000" />
  <title>WORDS — High-Fidelity Text Analysis</title>
  <meta name="description" content="Premium word and character counter with Hemingway analysis. Privacy-first, local execution." />
  
  <!-- Fonts: Outfit (Sans) + JetBrains Mono (Mono) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Outfit:wght@300;400;500;700;900&display=swap" rel="stylesheet">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Outfit', 'sans-serif'],
            mono: ['JetBrains Mono', 'monospace'],
          },
          colors: {
            black: '#000000',
            zinc: {
              850: '#1f1f22',
              900: '#18181b',
              950: '#09090b',
            },
            accent: {
              DEFAULT: '#00ccff', // Electric Blue
              glow: 'rgba(0, 204, 255, 0.15)',
            }
          },
          backgroundImage: {
            'grid-pattern': "linear-gradient(to right, #1f1f22 1px, transparent 1px), linear-gradient(to bottom, #1f1f22 1px, transparent 1px)",
          },
          animation: {
            'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'float': 'float 6s ease-in-out infinite',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' },
            }
          }
        }
      }
    }
  </script>

  <style>
    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: #000; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #444; }

    /* Glass Effects */
    .glass-panel {
      background: rgba(24, 24, 27, 0.6);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05);
    }
    
    .glass-input {
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(4px);
    }

    /* Selection */
    ::selection { background: rgba(0, 204, 255, 0.2); color: #fff; }

    /* Hemingway Highlights */
    .hw-very-hard { background: rgba(239, 68, 68, 0.2); border-bottom: 1px solid rgba(239, 68, 68, 0.4); }
    .hw-hard { background: rgba(234, 179, 8, 0.2); border-bottom: 1px solid rgba(234, 179, 8, 0.4); }
    .hw-adverb { border-bottom: 2px solid rgba(167, 139, 250, 0.6); }
    .hw-passive { border-bottom: 2px solid rgba(52, 211, 153, 0.6); }
    .hw-complex { border-bottom: 2px solid rgba(0, 204, 255, 0.6); }

    /* Utility */
    .text-balance { text-wrap: balance; }
  </style>
</head>
<body class="bg-black text-zinc-400 font-sans min-h-screen selection:bg-accent/20 overflow-x-hidden">

  <!-- Background Grid -->
  <div class="fixed inset-0 bg-[size:40px_40px] bg-grid-pattern opacity-20 pointer-events-none z-0"></div>
  <div class="fixed inset-0 bg-gradient-to-b from-black via-transparent to-black pointer-events-none z-0"></div>

  <!-- Header -->
  <header class="fixed top-0 w-full z-50 border-b border-white/5 bg-black/80 backdrop-blur-xl">
    <div class="max-w-[1400px] mx-auto px-6 h-16 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center">
          <svg class="w-4 h-4 text-accent" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
          </svg>
        </div>
        <h1 class="text-sm font-bold tracking-widest text-white">WORDS <span class="text-zinc-600 font-normal">/ ANALYZER</span></h1>
      </div>
      
      <div class="flex items-center gap-6">
        <div class="hidden md:flex items-center gap-2 text-xs font-mono">
          <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
          <span class="text-emerald-500">SYSTEM ACTIVE</span>
        </div>
        <a href="https://awais.dev" target="_blank" class="text-xs font-medium hover:text-white transition-colors">AWAIS.DEV</a>
      </div>
    </div>
  </header>

  <!-- Main Layout -->
  <main class="relative z-10 pt-24 pb-20 px-4 md:px-6 max-w-[1400px] mx-auto">
    
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
      
      <!-- Left Column: Input (lg:col-span-7) -->
      <div class="lg:col-span-7 flex flex-col gap-6">
        
        <!-- Editor Card -->
        <div class="glass-panel rounded-3xl p-1 min-h-[500px] flex flex-col relative group transition-all duration-500 hover:border-white/20">
          
          <!-- Toolbar -->
          <div class="flex items-center justify-between px-6 py-4 border-b border-white/5">
            <div class="flex items-center gap-4">
              <span class="text-xs font-bold tracking-wider text-zinc-500">INPUT SOURCE</span>
            </div>
            <div class="flex items-center gap-2">
              <button onclick="toggleHemingway()" id="btn-hemingway" class="px-3 py-1.5 text-[10px] font-bold tracking-wider uppercase border border-white/10 rounded-md hover:bg-white/5 hover:text-white transition-colors">Hemingway Mode</button>
              <button onclick="copyText()" class="px-3 py-1.5 text-[10px] font-bold tracking-wider uppercase border border-white/10 rounded-md hover:bg-white/5 hover:text-white transition-colors">Copy</button>
              <button onclick="clearText()" class="px-3 py-1.5 text-[10px] font-bold tracking-wider uppercase border border-red-500/20 text-red-400 rounded-md hover:bg-red-500/10 transition-colors">Clear</button>
            </div>
          </div>

          <!-- Text Area -->
          <div class="flex-1 relative p-6">
            <textarea 
              id="textInput" 
              class="w-full h-full bg-transparent border-none outline-none text-lg leading-relaxed text-zinc-200 placeholder-zinc-700 font-mono resize-none"
              placeholder="Start typing or paste your text here..."
              oninput="analyzeText()"
              spellcheck="false"
            ></textarea>
            
            <!-- Hemingway Overlay -->
            <div id="hemingway-view" class="absolute inset-6 pointer-events-none hidden text-lg leading-relaxed font-mono whitespace-pre-wrap break-words text-zinc-200"></div>
          </div>

          <!-- Footer Meta -->
          <div class="px-6 py-3 border-t border-white/5 flex items-center justify-between bg-black/20 rounded-b-[20px]">
             <div class="flex gap-4 text-xs font-mono text-zinc-500">
               <span><span id="char-count-inline" class="text-white">0</span> CHARS</span>
               <span><span id="word-count-inline" class="text-white">0</span> WORDS</span>
             </div>
             <div class="text-xs font-mono text-accent" id="reading-time-inline">~0s READ</div>
          </div>
        </div>

        <!-- Hemingway Legend (Hidden by default) -->
        <div id="hw-legend" class="hidden glass-panel rounded-xl p-4">
          <div class="flex flex-wrap gap-4 text-xs font-mono">
            <div class="flex items-center gap-2"><span class="w-3 h-3 rounded bg-red-500/20 border border-red-500/50"></span> Very Hard</div>
            <div class="flex items-center gap-2"><span class="w-3 h-3 rounded bg-yellow-500/20 border border-yellow-500/50"></span> Hard</div>
            <div class="flex items-center gap-2"><span class="w-3 h-3 border-b-2 border-violet-400"></span> Adverb</div>
            <div class="flex items-center gap-2"><span class="w-3 h-3 border-b-2 border-emerald-400"></span> Passive</div>
            <div class="flex items-center gap-2"><span class="w-3 h-3 border-b-2 border-accent"></span> Complex</div>
          </div>
        </div>

      </div>

      <!-- Right Column: Stats (lg:col-span-5) -->
      <div class="lg:col-span-5 flex flex-col gap-6">
        
        <!-- Primary Bento Grid -->
        <div class="grid grid-cols-2 gap-4">
          <!-- Total Words -->
          <div class="col-span-2 glass-panel rounded-3xl p-6 relative overflow-hidden group">
            <div class="absolute top-0 right-0 p-3 opacity-50 group-hover:opacity-100 transition-opacity">
               <svg class="w-5 h-5 text-white/20" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
            </div>
            <p class="text-xs font-bold tracking-widest text-zinc-500 mb-2 uppercase">Total Words</p>
            <h3 class="text-5xl md:text-6xl font-black text-white tracking-tighter" id="stat-words">0</h3>
            <div class="mt-4 h-1 w-full bg-white/5 rounded-full overflow-hidden">
              <div class="h-full bg-accent w-0 transition-all duration-700" id="progress-bar"></div>
            </div>
          </div>

          <!-- Characters -->
          <div class="glass-panel rounded-3xl p-6">
             <p class="text-[10px] font-bold tracking-widest text-zinc-500 mb-2 uppercase">Characters</p>
             <h3 class="text-3xl font-bold text-white font-mono" id="stat-chars">0</h3>
             <p class="text-xs text-zinc-600 mt-1">incl. spaces</p>
          </div>

          <!-- Sentences & Paragraphs -->
          <div class="glass-panel rounded-3xl p-6">
             <div class="flex flex-col h-full justify-between">
                <div>
                  <p class="text-[10px] font-bold tracking-widest text-zinc-500 mb-1 uppercase">Sentences</p>
                  <h3 class="text-2xl font-bold text-white font-mono" id="stat-sentences">0</h3>
                </div>
                <div class="mt-3 pt-3 border-t border-white/5">
                  <p class="text-[10px] font-bold tracking-widest text-zinc-500 mb-1 uppercase">Paragraphs</p>
                  <h3 class="text-xl font-bold text-zinc-300 font-mono" id="stat-paragraphs">0</h3>
                </div>
             </div>
          </div>
        </div>

        <!-- Secondary Stats -->
        <div class="glass-panel rounded-3xl p-6 grid grid-cols-3 gap-y-6 gap-x-4">
          
          <div class="col-span-1">
             <p class="text-[10px] text-zinc-500 uppercase tracking-wider mb-1">Read Time</p>
             <p class="text-xl font-bold text-white font-mono" id="stat-read-time">0s</p>
          </div>
          
          <div class="col-span-1">
             <p class="text-[10px] text-zinc-500 uppercase tracking-wider mb-1">Speak Time</p>
             <p class="text-xl font-bold text-white font-mono" id="stat-speak-time">0s</p>
          </div>

          <div class="col-span-1">
             <p class="text-[10px] text-zinc-500 uppercase tracking-wider mb-1">Unique</p>
             <p class="text-xl font-bold text-white font-mono" id="stat-unique-words">0</p>
          </div>

          <div class="col-span-1">
             <p class="text-[10px] text-zinc-500 uppercase tracking-wider mb-1">Grade Lvl</p>
             <p class="text-xl font-bold text-white font-mono" id="stat-grade">—</p>
          </div>

          <div class="col-span-1">
             <p class="text-[10px] text-zinc-500 uppercase tracking-wider mb-1">Ease Score</p>
             <p class="text-xl font-bold text-white font-mono" id="stat-ease">—</p>
          </div>

          <div class="col-span-1">
             <p class="text-[10px] text-zinc-500 uppercase tracking-wider mb-1">Complex</p>
             <p class="text-xl font-bold text-accent font-mono" id="stat-complex">0</p>
          </div>
        </div>

        <!-- Composition & Top Words -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            
            <!-- Composition -->
            <div class="glass-panel rounded-3xl p-6 flex flex-col gap-4">
              <p class="text-xs font-bold tracking-widest text-zinc-500 uppercase">Composition</p>
              
              <div class="space-y-3">
                <div class="flex items-center gap-3 text-xs">
                  <span class="w-14 text-zinc-500">Letters</span>
                  <div class="flex-1 h-1.5 bg-white/5 rounded-full overflow-hidden">
                    <div id="bar-letters-fill" class="h-full bg-zinc-400 w-0 transition-all duration-500"></div>
                  </div>
                </div>
                
                <div class="flex items-center gap-3 text-xs">
                  <span class="w-14 text-zinc-500">Numbers</span>
                  <div class="flex-1 h-1.5 bg-white/5 rounded-full overflow-hidden">
                    <div id="bar-numbers-fill" class="h-full bg-accent w-0 transition-all duration-500"></div>
                  </div>
                </div>
                
                <div class="flex items-center gap-3 text-xs">
                  <span class="w-14 text-zinc-500">Spaces</span>
                  <div class="flex-1 h-1.5 bg-white/5 rounded-full overflow-hidden">
                    <div id="bar-spaces-fill" class="h-full bg-white/20 w-0 transition-all duration-500"></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Top Words -->
            <div class="glass-panel rounded-3xl p-6 flex flex-col gap-4">
               <p class="text-xs font-bold tracking-widest text-zinc-500 uppercase">Top Keywords</p>
               <div id="top-words-list" class="space-y-2">
                 <!-- Populated by JS -->
                 <div class="text-xs text-zinc-600 italic">Start typing...</div>
               </div>
            </div>

        </div>

        <!-- Hidden Elements required for compatibility if I missed any refs -->
        <div class="hidden">
           <span id="pct-letters"></span>
           <span id="pct-numbers"></span>
           <span id="pct-spaces"></span>
        </div>

      </div>
    </div>
  </main>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-8 left-1/2 -translate-x-1/2 translate-y-8 opacity-0 transition-all duration-300 pointer-events-none z-50">
    <div class="glass-panel px-6 py-3 rounded-full flex items-center gap-3">
      <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
      <span id="toast-msg" class="text-sm font-bold text-white tracking-wide">COPIED</span>
    </div>
  </div>

  <script>
    // ── Logic Ported & Adapted ──
    const html = document.documentElement;

    // ── Regexes ──
    const EMOJI_RE = /\p{Emoji_Presentation}|\p{Extended_Pictographic}/gu;
    const NOT_ADVERBS = new Set(['only','early','family','likely','lonely','lovely','friendly','ugly','holy','jolly','silly','belly','bully','ally','rally','tally','jelly','smelly','daily','weekly','monthly','yearly','erly','erly','erly']);
    const PASSIVE_RE = /\b(am|is|are|was|were|be|been|being)\s+(\w+ly\s+)?(\w+ed|built|bought|brought|caught|dealt|felt|found|got|had|heard|held|kept|known|left|lost|made|meant|met|paid|put|read|said|seen|sent|shown|shut|sold|sent|set|spent|stood|taken|taught|told|thought|understood|won|written)\b/gi;
    const COMPLEX_PHRASES = [
      ['a number of','many'],['at the present time','now'],['due to the fact that','because'],
      ['in order to','to'],['in the event that','if'],['it is important to note','note'],
      ['it should be noted','note'],['on a daily basis','daily'],['prior to','before'],
      ['subsequent to','after'],['with regard to','about'],['in spite of the fact that','although'],
      ['for the purpose of','to'],['in the near future','soon'],['at this point in time','now'],
      ['in close proximity','near'],['in the majority of cases','usually'],['make a decision','decide'],
      ['take into consideration','consider'],['in the process of','while'],['a large number of','many'],
      ['at all times','always'],['in many cases','often'],['in some cases','sometimes'],
      ['it is possible that','perhaps'],['the question as to whether','whether'],
    ];

    // ── Helpers ──
    function countSyllables(word) {
      word = word.toLowerCase().replace(/[^a-z]/g, '');
      if (!word) return 0;
      if (word.length <= 3) return 1;
      word = word.replace(/(?:[^laeiouy]es|ed|[^laeiouy]e)$/, '');
      word = word.replace(/^y/, '');
      const m = word.match(/[aeiouy]{1,2}/g);
      return m ? m.length : 1;
    }
    function totalSyllables(words) { return words.reduce((s, w) => s + countSyllables(w), 0); }
    function fleschKincaidGrade(words, sentences, syllables) {
      if (!words || !sentences) return null;
      return 0.39 * (words / sentences) + 11.8 * (syllables / words) - 15.59;
    }
    function fleschReadingEase(words, sentences, syllables) {
      if (!words || !sentences) return null;
      return 206.835 - 1.015 * (words / sentences) - 84.6 * (syllables / words);
    }
    function countComplexPhrases(text) {
      const lower = text.toLowerCase();
      return COMPLEX_PHRASES.reduce((n, [phrase]) => {
        let idx = 0, count = 0;
        while ((idx = lower.indexOf(phrase, idx)) !== -1) { count++; idx += phrase.length; }
        return n + count;
      }, 0);
    }
    function sentenceDifficulty(sentence) {
      const words = sentence.trim().split(/\s+/).filter(Boolean);
      if (!words.length) return 0;
      const syls = totalSyllables(words);
      const avgSyl = syls / words.length;
      const grade = 0.39 * words.length + 11.8 * avgSyl - 15.59;
      if (grade >= 14 || words.length > 35) return 2;
      if (grade >= 10 || words.length > 20) return 1;
      return 0;
    }
    function escHtml(s) { return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
    function escRegex(s) { return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }
    function fmtTime(words, wpm) {
      const s = Math.round((words / wpm) * 60);
      if (s < 60) return s + 's';
      const m = Math.floor(s / 60), r = s % 60;
      return r ? `${m}m ${r}s` : `${m}m`;
    }
    function pct(v, t) { return t ? Math.round((v / t) * 100) + '%' : '0%'; }

    // ── Hemingway Logic ──
    function renderHemingway(text) {
      if (!text.trim()) return '';
      const parts = text.split(/([.!?]+\s*|\n+)/);
      let result = '';
      let buffer = '';
      const flushBuffer = () => {
        if (!buffer.trim()) { result += escHtml(buffer); buffer = ''; return; }
        const diff = sentenceDifficulty(buffer);
        let cls = diff === 2 ? 'hw-very-hard' : diff === 1 ? 'hw-hard' : '';
        const inner = highlightInline(buffer);
        if (cls) result += `<span class="${cls}">${inner}</span>`;
        else result += inner;
        buffer = '';
      };
      for (const part of parts) {
        if (/^[.!?]+\s*$/.test(part) || /^\n+$/.test(part)) { buffer += part; flushBuffer(); }
        else { buffer += part; }
      }
      if (buffer) flushBuffer();
      return result;
    }
    function highlightInline(text) {
      let out = escHtml(text);
      const sorted = [...COMPLEX_PHRASES].sort((a,b) => b[0].length - a[0].length);
      for (const [phrase, alt] of sorted) {
        const re = new RegExp(escRegex(phrase), 'gi');
        out = out.replace(re, m => `<span class="hw-complex" title="Consider: ${alt}">${m}</span>`);
      }
      out = out.replace(PASSIVE_RE, m => `<span class="hw-passive" title="Passive voice">${m}</span>`);
      out = out.replace(/\b([a-zA-Z]+ly)\b/g, (m) => {
        const lw = m.toLowerCase();
        if (lw.length > 4 && !NOT_ADVERBS.has(lw)) return `<span class="hw-adverb" title="Adverb">${m}</span>`;
        return m;
      });
      return out;
    }

    // ── Interactions ──
    let hemingwayActive = false;
    function toggleHemingway() {
      hemingwayActive = !hemingwayActive;
      const ta = document.getElementById('textInput');
      const view = document.getElementById('hemingway-view');
      const legend = document.getElementById('hw-legend');
      const btn = document.getElementById('btn-hemingway');
      if (hemingwayActive) {
        view.innerHTML = renderHemingway(ta.value);
        view.classList.remove('hidden');
        ta.classList.add('opacity-0'); 
        legend.classList.remove('hidden');
        btn.classList.add('bg-white/10', 'text-white', 'border-white/30');
      } else {
        view.classList.add('hidden');
        ta.classList.remove('opacity-0');
        legend.classList.add('hidden');
        btn.classList.remove('bg-white/10', 'text-white', 'border-white/30');
      }
    }
    function setStat(id, val) {
      const el = document.getElementById(id);
      if (!el) return;
      const v = String(val);
      if (el.textContent === v) return;
      el.textContent = v;
      el.classList.add('scale-110', 'text-accent');
      setTimeout(() => el.classList.remove('scale-110', 'text-accent'), 150);
    }
    function toast(msg) {
      const el = document.getElementById('toast');
      document.getElementById('toast-msg').textContent = msg;
      el.classList.remove('translate-y-8', 'opacity-0');
      setTimeout(() => el.classList.add('translate-y-8', 'opacity-0'), 2000);
    }
    function clearText() {
      const input = document.getElementById('textInput');
      if (input.value && !window.confirm('Clear all text?')) return;
      input.value = '';
      if (hemingwayActive) toggleHemingway();
      analyzeText();
      toast('CLEARED');
    }
    function copyText() {
      const t = document.getElementById('textInput').value;
      if (!t) { toast('EMPTY'); return; }
      navigator.clipboard.writeText(t).then(() => toast('COPIED'));
    }

    // ── Main Analysis ──
    function analyzeText() {
      const text = document.getElementById('textInput').value;
      const total = text.length;
      const words = text.trim() ? text.trim().split(/\s+/).filter(Boolean) : [];
      const wc = words.length;
      const sentenceList = text.split(/[.!?]+/).filter(s => s.trim());
      const sentences = sentenceList.length;
      const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim()).length;
      
      const letters = (text.match(/[a-zA-Z]/g) || []).length;
      const numbers = (text.match(/[0-9]/g) || []).length;
      const spaces = (text.match(/\s/g) || []).length;
      
      const sylCount = totalSyllables(words);
      const fkGrade  = fleschKincaidGrade(wc, sentences, sylCount);
      const fkEase   = fleschReadingEase(wc, sentences, sylCount);
      const complex  = countComplexPhrases(text);
      const unique   = new Set(words.map(w => w.toLowerCase())).size;
      const readTime  = fmtTime(wc, 238);
      const speakTime = fmtTime(wc, 130);

      // DOM Updates
      setStat('stat-words', wc.toLocaleString());
      setStat('stat-chars', total.toLocaleString());
      setStat('stat-sentences', sentences.toLocaleString());
      setStat('stat-paragraphs', paragraphs.toLocaleString());
      setStat('stat-read-time', readTime);
      setStat('stat-speak-time', speakTime);
      setStat('stat-unique-words', unique.toLocaleString());
      setStat('stat-complex', complex.toLocaleString());

      if (fkGrade !== null) {
        document.getElementById('stat-grade').textContent = Math.max(0, fkGrade).toFixed(1);
        document.getElementById('stat-ease').textContent = Math.min(100, Math.max(0, fkEase)).toFixed(0);
      } else {
        document.getElementById('stat-grade').textContent = '—';
        document.getElementById('stat-ease').textContent = '—';
      }

      const updateBar = (id, count, total) => {
        const el = document.getElementById(id);
        if(el) el.style.width = total ? (count/total)*100 + '%' : '0%';
      };
      updateBar('bar-letters-fill', letters, total);
      updateBar('bar-numbers-fill', numbers, total);
      updateBar('bar-spaces-fill', spaces, total);

      document.getElementById('char-count-inline').textContent = total.toLocaleString();
      document.getElementById('word-count-inline').textContent = wc.toLocaleString();
      document.getElementById('reading-time-inline').textContent = `~${readTime} READ`;

      if (hemingwayActive) document.getElementById('hemingway-view').innerHTML = renderHemingway(text);
      
      const progress = Math.min(100, (wc / 1000) * 100);
      document.getElementById('progress-bar').style.width = progress + '%';

      // Top Words
      const freq = {};
      const stopWords = new Set(['the','a','an','and','or','but','in','on','at','to','for','of','with','is','it','this','that','was','are','be','as','by','from','have','has','had','not','we','you','i','he','she','they','do','did','will','would','could','should','may','might','can','its','our','your','their','my','his','her']);
      words.forEach(w => { 
        const c = w.toLowerCase().replace(/[^a-z0-9']/g,''); 
        if(c && !stopWords.has(c) && c.length > 2) freq[c]=(freq[c]||0)+1; 
      });
      const topWords = Object.entries(freq).sort((a,b) => b[1]-a[1]).slice(0, 5);
      
      const topWordsContainer = document.getElementById('top-words-list');
      if (wc === 0) {
        topWordsContainer.innerHTML = '<div class="text-xs text-zinc-600 italic">Start typing...</div>';
      } else if (topWords.length === 0) {
        topWordsContainer.innerHTML = '<div class="text-xs text-zinc-600 italic">No meaningful words yet</div>';
      } else {
        topWordsContainer.innerHTML = topWords.map(([w, c]) => `
          <div class="flex items-center justify-between text-xs">
            <span class="text-zinc-400 truncate w-24">${w}</span>
            <div class="flex-1 mx-2 h-1 bg-white/5 rounded-full"><div class="h-full bg-zinc-600 rounded-full" style="width:${(c/topWords[0][1])*100}%"></div></div>
            <span class="text-white font-mono min-w-[1.5rem] text-right">${c}</span>
          </div>
        `).join('');
      }
    }

    analyzeText();
    window.onload = () => document.body.classList.add('opacity-100');
  </script>
</body>
</html>
